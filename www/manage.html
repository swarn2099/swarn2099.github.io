<!DOCTYPE html>
<html>

<head>
  <!--Import Google Icon Font-->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!--Import materialize.css-->
  <link type="text/css" rel="stylesheet" href="../css/materialize.min.css" media="screen,projection" />
  <link type="text/css" rel="stylesheet" href="../css/style.css" media="screen,projection" />
  <script src="../js/medium-editor.js"></script>
  <link rel="stylesheet" href="../css/medium-editor.css">
  <link rel="stylesheet" href="../css/default.css">
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css"> -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
  <script src="https://www.gstatic.com/firebasejs/4.13.0/firebase.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.0.4/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.0.4/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.13.0/firebase-firestore.js"></script>
  <script>
    // Initialize Firebase
    firebase.initializeApp({
      apiKey: "AIzaSyCvM4gKXyUW58BrDOnqU3bJBGnCNiexCzI",
      authDomain: "marco-polo-c90db.firebaseapp.com",
      projectId: "marco-polo-c90db",
    });
    const firestore = firebase.firestore();
    const settings = { /* your settings... */
      timestampsInSnapshots: true
    };
    firestore.settings(settings);
    // Initialize Cloud Firestore through Firebase
    var db = firebase.firestore();
    var user = firebase.auth().currentUser;
  </script>
  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script type="text/javascript" src="../js/jquery-3.3.1.min.js"></script>
  <script type="text/javascript" src="../js/init.js"></script>
  <script src="../js/markdown.js"></script>
  <script src="../js/locationpicker.js"></script>
</head>
<script>
  function queryResults() {
    console.log("The fucntion ran");
    firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        var displayName = user.displayName;
        console.log(displayName);
        var welcome = document.getElementById("welcomeMessage");
        welcome.innerHTML = "Welcome " + displayName + "    ";
        // User is signed in.
        db.collection("events").where("author", "==", user.uid).get().then(function(querySnapshot) {
          querySnapshot.forEach(function(doc) {
            // doc.data() is never undefined for query doc snapshots
            console.log(doc.id, " => ", doc.data());
            // var option = '<a href="#!" class="collection-item" id="' + doc.id + '">' + doc.data().name + '</a>';
            var option = '<option>'+doc.data().name+'</option>';
            console.log(option);
            var optionPreview = document.getElementById("optionArea");
            optionPreview.innerHTML += option;
          });
        });
      } else {
        // No user is signed in.
      }
    });

  };

  function signOut() {
    firebase.auth().signOut().then(function() {
      console.log('Signed Out');
      window.location.href = "signin.html";

    }, function(error) {
      console.error('Sign Out Error', error);
    });
  }
</script>

<ul id="slide-out" class="sidenav sidenav-fixed center"><br>
  <li><a href="home.html"><i class="material-icons small center">home</i></a></li>
  <li><a href="add.html"><i class="material-icons small">add</i></a></li>
  <li><a href="manage.html"><i class="material-icons small">edit</i></a></li>
  <li><a href="#!"><i class="material-icons small">notifications_active</i></a></li>
  <li><a href="#!" onclick="signOut()"><i class="material-icons small">hotel</i></a></li>
</ul>
<nav>
  <div class="nav-wrapper white black-text">
    <a href="home.html" class="brand-logo center"><span class="teal-text text-lighten-2"><b>marco</b></span><span class="blue-text heavy">polo </span><span class="thin black-text hide-on-med-and-down">Pool</span></a>
    <a href="#" data-target="slide-out" class="sidenav-trigger"><i class="material-icons black-text">menu</i></a>
    <ul class="right hide-on-med-and-down black-text">
      <li>
        <a class="dropdown-trigger black-text" href="#!" data-target="dropdown1" id="welcomeMessage">
          <div></div><i class="material-icons right">arrow_drop_down</i></a>
      </li>
      <ul id='dropdown1' class='dropdown-content'>
        <li><a href="#!">Account Help</a></li>
        <li><a href="#!" onclick="signOut()">Sign Out</a></li>
      </ul>
    </ul>
  </div>
</nav>


<body onload="queryResults()">
  <div class="centeredLeft container center">

    <div class="input-field col s12">
      <select id="optionArea">

      </select>
      <label>Choose Event</label>
    </div>
  </div>

  <script type="text/javascript" src="../js/materialize.min.js"></script>
</body>

</html>
